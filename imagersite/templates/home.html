{% extends "base.html" %}
{% block content %}
{% load leaflet_tags %}
{% load staticfiles %}

{% block head %}
    {% leaflet_js %}
    {% leaflet_css %}
{% endblock %}

<body>
<h3>
    {% if user.is_authenticated %}
        You have changed the world.
    {% else %}
        Sign up now and change the world.
    {% endif %}
</h3>
    <div class="img-responsive center-block">
        <img class="img-responsive center-block"
        {% if pic_url %}
        src="{{ MEDIA_URL }}{{ pic_url.file }}"
        {% else %}
        src="{% static 'imager_images/demo.jpg' %}"
        {% endif %}
        >


{% leaflet_map "main" callback="main_map_init" %}
        <script type="text/javascript">
        function main_map_init (map, options) {
            {% for photo in photos %}
            var dataurl = '{% url "p_geodata" photo.id %}';
            // Download GeoJSON via Ajax
            $.getJSON(dataurl, function (data) {
            // Add GeoJSON layer
            L.geoJson(data).addTo(map);
            });
            {% endfor %}
        }
    </script>
    </div>
</body>

{% endblock %}